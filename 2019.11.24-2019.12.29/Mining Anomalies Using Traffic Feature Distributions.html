<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Mining Anomalies Using Traffic Feature Distributions</title>
</head>
<body>
<div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_SVG_Hidden"></div><svg><defs id="MathJax_SVG_glyphs"><path id="MJMATHI-3B1" stroke-width="1" d="M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374Q564 388 566 390T582 393Q603 393 603 385Q603 376 594 346T558 261T497 161L486 147L487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62Q597 56 591 43Q579 19 556 5T512 -10H505Q438 -10 414 62L411 69L400 61Q390 53 370 41T325 18T267 -2T203 -11Q124 -11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290Q382 405 304 405Q235 405 183 332Q156 292 139 224T121 120Q121 71 146 49T208 26Z"></path><path id="MJMATHI-48" stroke-width="1" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 219 683Q260 681 355 681Q389 681 418 681T463 682T483 682Q499 682 499 672Q499 670 497 658Q492 641 487 638H485Q483 638 480 638T473 638T464 637T455 637Q416 636 405 634T387 623Q384 619 355 500Q348 474 340 442T328 395L324 380Q324 378 469 378H614L615 381Q615 384 646 504Q674 619 674 627T617 637Q594 637 587 639T580 648Q580 650 582 660Q586 677 588 679T604 682Q609 682 646 681T740 680Q802 680 835 681T871 682Q888 682 888 672Q888 645 876 638H874Q872 638 869 638T862 638T853 637T844 637Q805 636 794 634T776 623Q773 618 704 340T634 58Q634 51 638 51Q646 48 692 46H723Q729 38 729 37T726 19Q722 6 716 0H701Q664 2 567 2Q533 2 504 2T458 2T437 1Q420 1 420 10Q420 15 423 24Q428 43 433 45Q437 46 448 46H454Q481 46 514 49Q520 50 522 50T528 55T534 64T540 82T547 110T558 153Q565 181 569 198Q602 330 602 331T457 332H312L279 197Q245 63 245 58Q245 51 253 49T303 46H334Q340 38 340 37T337 19Q333 6 327 0H312Q275 2 178 2Q144 2 115 2T69 2T48 1Q31 1 31 10Q31 12 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"></path><path id="MJMAIN-5F" stroke-width="1" d="M0 -62V-25H499V-62H0Z"></path><path id="MJMAIN-2212" stroke-width="1" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path id="MJMATHI-68" stroke-width="1" d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z"></path><path id="MJMAIN-5E" stroke-width="1" d="M112 560L249 694L257 686Q387 562 387 560L361 531Q359 532 303 581L250 627L195 580Q182 569 169 557T148 538L140 532Q138 530 125 546L112 560Z"></path><path id="MJMAIN-7E" stroke-width="1" d="M179 251Q164 251 151 245T131 234T111 215L97 227L83 238Q83 239 95 253T121 283T142 304Q165 318 187 318T253 300T320 282Q335 282 348 288T368 299T388 318L402 306L416 295Q375 236 344 222Q330 215 313 215Q292 215 248 233T179 251Z"></path><path id="MJMAIN-33" stroke-width="1" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path><path id="MJMATHI-3C3" stroke-width="1" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z"></path></defs></svg></div><div id="wmd-preview" class="wmd-preview"><div class="md-section-divider"></div><div class="md-section-divider"></div><h1 data-anchor-id="ekjw" id="mining-anomalies-using-traffic-feature-distributions">Mining Anomalies Using Traffic Feature Distributions</h1><div class="md-section-divider"></div><h3 data-anchor-id="9ypm" id="sigcomm05-august-2126-2005">SIGCOMM’05, August 21–26, 2005</h3><div class="md-section-divider"></div><h4 data-anchor-id="dbl2" id="anukool-lakhinamark-crovellachristophe-diot">Anukool Lakhina，Mark Crovella，Christophe Diot</h4><p data-anchor-id="qhfv"><code>论文</code></p><hr><p data-anchor-id="4aqu">2005年的论文，可能在十年前论文的影响力还是挺大的，但是现在感觉一般，而且有一个关键位置没有读懂，所以可能不能完整理解论文的意思。此外，实验部分有些冗余。</p><p data-anchor-id="hubw">论文题目为：使用流量特征分布挖掘异常，即使用 <strong>源IP、源端口、目的IP和目的端口的熵</strong> 区分<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -463.9033013280564 640.5 496.80660265611283" style="width: 1.444ex; height: 1.111ex; vertical-align: -0.222ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B1"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1">\alpha</script>流、DoS攻击、flash crowd、端口扫描、网络扫描、中断事件、点到多点、蠕虫攻击。 <br>
<img src="https://s2.ax1x.com/2019/12/20/QOhvRI.png" alt="QOhvRI.png"></p><div class="md-section-divider"></div><h4 data-anchor-id="6b2n" id="特征分布"><strong>特征分布</strong></h4><ul data-anchor-id="wktc">
<li>首先说明在 <strong>正常时期</strong> 和 <strong>攻击时期</strong>，目的IP和目的端口的分布确实有所不同【正常时期，分布比较分散，而攻击时期，比较集中】。 <br>
<img src="https://s2.ax1x.com/2019/12/20/QOhLIH.png" alt="QOhLIH.png"></li>
<li>其次说存在攻击，通过数量特征无法分辨，而通过熵的特征可以区别。 <br>
<img src="https://s2.ax1x.com/2019/12/20/QOhXid.png" alt="QOhXid.png" title=""></li>
</ul><div class="md-section-divider"></div><h4 data-anchor-id="2v1r" id="诊断方法"><strong>诊断方法</strong></h4><ul data-anchor-id="svly">
<li>首先将源IP、目的IP、源端口、目的端口的熵按照行为时间t、列为流p的矩阵组织为<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><span style="display: inline-block; white-space: nowrap; padding: 1px 0px;"><span style="display: inline-block; position: relative; width: 2.222ex; height: 2.333ex; vertical-align: -0.778ex;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="-37.075 -704.9033013280564 972.5 1177.8066026561128" style="width: 2.222ex; height: 2.778ex; position: absolute; bottom: -0.333ex; left: 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-48" x="42" y="0"></use><g transform="translate(-38,-452)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2212" x="-85" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2212" x="194" y="0"></use></g></g></svg></span></span></span><script type="math/tex" id="MathJax-Element-2">\underline{H}</script>=t*p*4，并进行PCA，得到主成分。 <br>
<img src="https://s2.ax1x.com/2019/12/20/QOh7qO.png" alt="QOh7qO.png" title=""></li>
<li>然后将<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><span style="display: inline-block; white-space: nowrap; padding: 1px 0px;"><span style="display: inline-block; position: relative; width: 2.222ex; height: 2.333ex; vertical-align: -0.778ex;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="-37.075 -704.9033013280564 972.5 1177.8066026561128" style="width: 2.222ex; height: 2.778ex; position: absolute; bottom: -0.333ex; left: 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-48" x="42" y="0"></use><g transform="translate(-38,-452)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2212" x="-85" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2212" x="194" y="0"></use></g></g></svg></span></span></span><script type="math/tex" id="MathJax-Element-3">\underline{H}</script>拆为H=t*4p，即列变化[1，p]为源IP的熵，[p+1，2p]为源端口的熵，[2p+1，3p]为目的IP的熵，[3p+1，4p]为目的端口的熵。</li>
<li>对H的每一行h进行分析，选择其中的主成分记为<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -952.6623013280564 576.5 985.5656026561128" style="width: 1.333ex; height: 2.333ex; vertical-align: -0.222ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-68"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-5E" x="10" y="236"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4">\hat{h}</script>，剩余部分为<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -892.6623013280564 576.5 925.5656026561128" style="width: 1.333ex; height: 2.111ex; vertical-align: -0.222ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-68"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-7E" x="10" y="552"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5">\tilde{h}</script>。如果<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -892.6623013280564 576.5 925.5656026561128" style="width: 1.333ex; height: 2.111ex; vertical-align: -0.222ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-68"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-7E" x="10" y="552"></use></g></svg></span><script type="math/tex" id="MathJax-Element-6">\tilde{h}</script>的长度比较大，说明出现了异常。</li>
<li>没有读懂阈值确定的过程。</li>
<li>在判断出现异常之后，使用非监督的机器学习算法对异常进行分类。</li>
</ul><div class="md-section-divider"></div><h4 data-anchor-id="fitr" id="实验"><strong>实验</strong></h4><p data-anchor-id="faow">（1）熵实验</p><ul data-anchor-id="ubv4">
<li>首先对比基于熵和基于数量的检测方法的差异，结果表明<strong>熵和字节数检测到的异常几乎完全不同，而熵和数据包都可以检测多种异常，但是熵可以检测更多。</strong> <br>
<img src="https://s2.ax1x.com/2019/12/20/QOhjJA.png" alt="QOhjJA.png" title=""></li>
<li>检测已知攻击中，<strong>为了避免设计的数据特征出现偶然</strong>，先获取攻击流量，并将攻击流量的头部随机映射为本地主机地址。实验结果表明，熵比基于数量的灵敏，并且熵比基于数量的可以检测更多的攻击【和上面的实验结果相同，不明白为什么要做两组】。 <br>
<img src="https://s2.ax1x.com/2019/12/20/QOhxzt.png" alt="QOhxzt.png" title=""></li>
</ul><p data-anchor-id="1g56">（2）聚类实验</p><ul data-anchor-id="8ztg">
<li>实验证明将实验数据中的异常聚类为10组效果最好。 <br>
<img src="https://s2.ax1x.com/2019/12/20/QO4SQP.png" alt="QO4SQP.png" title=""></li>
<li>如下为每个类别异常的范围和使用本论文算法得到的结果。在<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -686.9033013280564 1073 730.8066026561128" style="width: 2.444ex; height: 1.667ex; vertical-align: -0.222ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-33"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3C3" x="500" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-7">3\sigma</script>之内为0，大于<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -686.9033013280564 1073 730.8066026561128" style="width: 2.444ex; height: 1.667ex; vertical-align: -0.222ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-33"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3C3" x="500" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-8">3\sigma</script>为+，小于0为负。基本上与第一张图中对应的攻击特征相符。 <br>
<img src="https://s2.ax1x.com/2019/12/20/QOoofH.png" alt="QOoofH.png" title=""></li>
</ul></div>
</body>
</html>